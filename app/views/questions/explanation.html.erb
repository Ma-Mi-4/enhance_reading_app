<h1>解説: <%= @question_set.title %></h1>

<div style="white-space: pre-wrap;">
  <%= simple_format(@question_set.content) %>
</div>

<% @questions.each_with_index do |q, index| %>
  <div style="margin-bottom: 20px; padding: 15px; border: 1px solid #ccc; border-radius: 8px;">
    
    <!-- 問題文 -->
    <p><strong>問題 <%= index + 1 %>:</strong> <%= q.body %></p>

    <!-- 正解表示 -->
    <p style="color: green; font-weight: bold;">
      正解: <%= q.choices_text[q.correct_index] %>
    </p>

    <hr>

    <!-- 間違いの選択肢とその解説 -->
    <h4>間違いの選択肢と解説：</h4>

    <% q.choices_text.each_with_index do |choice, i| %>
      <% next if i == q.correct_index %>

      <% wrong_explanation =
           q.wrong_explanations.present? ?
             q.wrong_explanations[i] : nil %>

      <p>
        <strong><%= choice %></strong>：
        <%= wrong_explanation.present? ? wrong_explanation : "（解説なし）" %>
      </p>
    <% end %>

    <!-- 全体の解説 -->
    <% if q.explanation.present? %>
      <p><strong>解説:</strong> <%= q.explanation %></p>
    <% end %>

    <!-- JSON 由来の例文（ある場合のみ）-->
    <% if q.respond_to?(:example_sentence) && q.example_sentence.present? %>
      <p><strong>例文:</strong> <%= q.example_sentence %></p>
    <% end %>

  </div>
<% end %>

<%= link_to "次の問題へ進む", next_question_path, class: "btn btn-primary" %>

