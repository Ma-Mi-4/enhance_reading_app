<% content_for :body_attributes do %>
  data-page="explanation" data-turbo="false"
<% end %>

<div class="page-container">

  <h1 class="text-center text-xl font-semibold mb-8">
    解説: <%= @question_set.title %>
  </h1>


  <!-- Part7 本文 -->
  <div class="max-w-3xl mx-auto mb-10 text-left leading-loose text-base">
    <%= simple_format(@question_set.content) %>
  </div>

  <% @questions.each_with_index do |q, index| %>

    <div class="question-block max-w-3xl mx-auto mb-10 text-left">

      <p class="leading-relaxed mb-4">
        <strong>問題 <%= index + 1 %>:</strong>
        <%= q[:body] %>
      </p>

      <p class="font-semibold text-green-600 mb-4">
        正解：<%= q[:choices][q[:correct_index]] %>
      </p>

      <hr class="my-4">

      <h4 class="font-semibold mb-3">
        間違いの選択肢と解説：
      </h4>

      <% q[:choices].each_with_index do |choice, i| %>
        <% next if i == q[:correct_index] %>

        <% wrong_explanation =
             q[:wrong_explanations].present? ?
               q[:wrong_explanations][i] : nil %>

        <p class="text-sm leading-relaxed mb-3">
          <strong><%= choice %></strong>：
          <%= wrong_explanation.presence || "（解説なし）" %>
        </p>
      <% end %>

      <% if q[:explanation].present? %>
        <p class="mt-4 leading-relaxed"><strong>解説:</strong> <%= q[:explanation] %></p>
      <% end %>

      <% if q[:example_sentence].present? %>
        <p class="mt-3 text-sm leading-relaxed text-gray-700"><strong>例文:</strong> <%= q[:example_sentence] %></p>
      <% end %>

    </div>

  <% end %>

  <% quiz_set = QuizSet.find_by(question_set_id: @question_set.id) %>

  <% if quiz_set.present? %>
    <%= link_to "復習問題へ", quiz_path(quiz_set.uuid), class: "btn btn-primary" %>
  <% end %>

</div>
