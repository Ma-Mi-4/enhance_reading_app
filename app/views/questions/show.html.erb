<% content_for :body_attributes do %>
  data-page="show" data-turbo="false" data-has-timer="true"
<% end %>

<div class="max-w-3xl mx-auto px-4 py-8">

  <!-- タイトル -->
  <h1 class="text-2xl font-bold text-center mb-6">
    <%= @question_set.title %>
  </h1>

  <!-- 長文 -->
  <div class="mb-10 text-gray-800 leading-relaxed">
    <%= simple_format(@question_set.content) %>
  </div>

  <%= form_with url: explanation_question_path(@question_set.uuid),
        method: :post,
        local: true,
        id: "question_form",
        data: { correct: @correct_indexes.to_json } do |f| %>

    <!-- タイマー -->
    <div id="timer" class="text-lg font-medium mb-6 text-center">
      00:00
    </div>

    <%= f.hidden_field :study_seconds, value: 0, id: "study_seconds" %>
    <%= f.hidden_field :accuracy, value: 0, id: "accuracy_field_questions" %>

    <% @questions.each_with_index do |q, index| %>
      <div class="mb-10">

        <!-- 問題文 -->
        <p class="mb-4 text-base font-medium">
          Question <%= index + 1 %>：
          <span class="font-normal"><%= q[:body] %></span>
        </p>

        <!-- 選択肢 -->
        <div class="space-y-3">
          <% q[:choices].each_with_index do |choice, i| %>
            <label class="flex items-start gap-3 p-4 border rounded-md
                          cursor-pointer hover:bg-gray-50
                          has-[:checked]:border-blue-600
                          has-[:checked]:bg-blue-50">

              <input type="radio"
                     name="q<%= index %>"
                     value="<%= i %>"
                     id="q<%= index %>_choice<%= i %>"
                     class="mt-1 h-4 w-4 text-blue-600">

              <span class="text-base">
                <%= choice %>
              </span>
            </label>
          <% end %>
        </div>

      </div>
    <% end %>

    <!-- 解説ボタン -->
    <div class="text-center">
      <%= f.submit "解説を見る",
            class: "btn-outline mt-4" %>
    </div>

  <% end %>

</div>
