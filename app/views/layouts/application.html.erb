<!DOCTYPE html>
<html>
  <head>
    <title>TOEIC長文トレーニング</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2/dist/umd/popper.min.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js?v=2" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.5.1/dist/chart.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@4.2.1/dist/chartjs-plugin-annotation.umd.js"></script>
  </head>

  <body data-turbo="false" <%= yield :body_attributes %>>
    <%= render 'shared/header' %>

    <% flash.each do |key, message| %>
      <div class="alert alert-<%= key == 'notice' ? 'success' : 'danger' %>">
        <%= message %>
      </div>
    <% end %>

    <%= yield %>

    <%= render 'shared/footer' %>

    <script>
      if (window.Chart && window['chartjs-plugin-annotation']) {
        Chart.register(window['chartjs-plugin-annotation']);
      }

      console.log("Chart.js loaded:", window.Chart);
      console.log("Annotation plugin loaded:", window['chartjs-plugin-annotation']);
    </script>
  </body>
</html>
